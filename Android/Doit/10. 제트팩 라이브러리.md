# 10.제트팩 라이브러리

## 제트팩과 androidx 소개
### 플랫폼 API
* 플랫폼 API는 ART에서 제공하는 안드로이드 라이브러리

### 제트팩
* 제트팩은 구글에서 안드로이드 앱 개발용으로 제공하는 다양한 라이브러리 모음
* androidx로 시작하는 패키지명을 사용
  * 앱을 개발하는 데 필요한 권장 아키텍처를 제공한다.
  * API 레벨의 호환성 문제를 해결한다.
  * 플랫폼 API에서 제공하지 않는 다양한 기능을 제공한다.

### androidx 라이브러리
* 화면 구성과 관련된 라이브러리
  * androidx.appcompat: 앱의 API 레벨 호환성을 해결
  * androidx.recyclerview: 목록 화면을 구성
  * androidx.viewpager2: 스와이프로 넘기는 화면을 구성
  * androidx.fragment: 액티비티처럼 동작하는 뷰를 제공
  * androidx.drawerlayout: 옆에서 서랍처럽 열리는 화면을 구성

## appcompat 라이브러리
* appcompat 라이브러리는 안드로이드 앱의 화면을 구성하는 액티비티를 만들어 API 레벨의 호환성 문제를 해결

### 액션바
* 화면 위쪽에 타이틀 문자열이 출력되는 영역
* 내비게이션 아이콘, 액션 아이템, 오버플로 메뉴 등 다양한 요소를 액션바에 출력할 수 있다.

* 액션바 색상 설정
  * 테마 스타일은 res/values 디렉터리에 있는 themes.xml 파일에 선언
* 액션바 숨기기 설정
  * Theme.MaterialComponents.DayNight.NoActionBar를 상속받으면 액션바가 나오지 않는다.
* 업 버튼 설정
  * 액션바 왼쪽에 이전 화면으로 되돌아가는 화살표 모양(<-)의 업 버튼을 제공할 수 있다.
  ```
  매니페스트 파일에서 업 버튼 설정
  <activity
    android:name=".TwoActivity"
    android:parentActivityName=".MainActivity"></activity>
    
  업 버튼 클릭 시 자동으로 호출되는 함수 재정의
  override fun onSupportNavigateUp(): Boolean {
    return super.onSupportNavigateUp()
  }
  
  액티비티 코드에서 업 버튼 설정
  class TwoActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?)  {
      ...
      supportActionBar?.setDisplayHomeAsUpEnabled(true)
    }
    override fun onSupportNavigateUp(): Boolean {
      onBackPressed()
      return super.onSupportNavigateUp()
    }
  }
  ```
  
### 메뉴 구성
* 메뉴는 액션바의 중요한 구성 요소로 액티비티 화면에서 사용자 이벤트를 사용할 수 있도록 한다.
* 액티비티에 메뉴를 추가하고 싶다면 onCreateOptionMenu()와 onPrepareOptionsMenu() 함수를 이용
* onCreateOptionMenu() 함수는 액티비티가 실행되면서 처음에 한 번만 호출
* onPrepareOptionsMenu() 함수는 액티비티가 실행되면서 한 번 호출된 후 오버플로 메뉴가 나타날 때마다 반복해서 호출
```
메뉴 구성 함수
override fun onCreateOptionMenu(menu: Menu?): Boolean {
  val menuItem1: MenuItem? = menu?.add(0, 0, 0, "menu1")
  val menuItem2: MenuItem? = menu?.add(0, 1, 0, "menu2")
  return super.onCreateOptionMenu(menu)
}
```
* 메뉴를 사용자가 선택했을 때의 이벤트 처리는 onOptionsItemSelected() 함수를 이용
* 함수의 매개변수는 이벤트가 발생한 메뉴 객체인 MenuItem
```
메뉴 선택 시 이벤트 처리
override fun onOptionsItemSelected(item: MenuItem): Boolean = when (item.itemId) {
  0 -> {
      true
  }
  1 -> {
      true
  }
  else -> super.onOptionItemSelected(item)
}
```

* 리소스로 메뉴 구현
  * 메뉴를 구성하는 XML 파일은 res 폴더 아래 menu 디렉터리에 만든다.

* 액션바에 아이콘으로 나타나게 하려면 showAsAction 속성을 이용
* never(기본): 항상 오버플로 메뉴로 출력한다.
* ifRoom: 만약 액션바에 공간이 있다면 액션 아이템으로, 없다면 오버플로 메뉴로 출력한다.
* always: 항상 액션 아이템으로 출력한다.
```
액티비티 코드에 메뉴 XML 적용
override fun onCreateOptionsMenu(menu: Menu?): Boolean {
  menuInfalter.inflate(R.menu.menu_main, menu)
  return super.onCreateOptionsMenu(menu)
}
```
* 액션 뷰 이용
  * 액션 뷰는 액션바에서 특별한 기능을 제공하며 대표적으로 androidx.appcompat.widget.SearchView가 있다.
  * SearchView를 등록한 MenuItem 객체를 얻고 MenuItem 객체에 등록된 SearchView 객체를 구하면 된다.
  ```
  서치 뷰 검색 기능 구현
  override fun onCreateOptionsMenu(menu: Menu): Boolean {
    val infalter = menuInflater
    inflater.inflate(R.menu.menu_main, menu)
    val menuItem = menu?.findItem(R.id.menu_search)
    val searchView = menuItem?.actionView as SearchView
    searchView.setOnQueryTextListener(object: SearchView.OnQueryTextListener {
      override fun onQueryTextChange(newText: String?): Boolean { // 검색어 변경 이벤트
        return true
      }
      override fun onQueryTextSubmit(query: String?): Boolean {
        return true
      }
    })
    return true
  }
  ```
### 툴바
* 액션바는 액티비티 창이 자동으로 출력하는 액티비티의 구성 요소지만, 툴바는 개발자가 직접 제어하는 뷰라는 데 차이점
* 레이아웃 XML 파일에 다음처럼 Toolbar를 등록
  ```
  <androidx.appcompat.widget.Toolbar
    ...
    />
  
  class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?)
      ...
      setSupportActionBar(binding.toolbar)
    }
  }
  ```
### 호환성을 고려한 기본 뷰 클래스
* 플랫폼 API 에서 제공하는 기본 뷰를 appcompat 라이브러리에서도 제공
* TextView 클래스를 appcompat 라이브러리에서는 AppCompatTextView라는 클래스명으로 제공
* AppCompatImageView, AppCompatEditText, AppCompatButton, AppCompatCheckBox, AppCompatRadioButton 등 기본 뷰에 해당하는 뷰를 제공


      
